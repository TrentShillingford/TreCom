<html>
    <head>

        <meta charset = "UTF-8">
        <meta meta http-equiv="Content-Type" content="text/html">
        <meta name="description" content="Welcome to a new eCommerce platform!">
        <meta name="author" content="Trent Shillingford">
        <meta name = "keywords" content = "Trecom, eCommerce, shopping">
        <meta name = "viewport" content = "width = device-width, initial-scale = 1.0"> 
        <link rel="shortcut icon" href="data:;base64,iVBORw0KGgo=">
        <title>TreCom Website</title>

        <!--Font for the Title-->
        <link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet" type="text/css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Zen+Tokyo+Zoo&display=swap" rel="stylesheet"> 

        <!--Font for the form headers-->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" rel="stylesheet">  
        
        <!--Font for the navigation bar text-->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@500&display=swap" rel="stylesheet"> 
        
        <!--Custom CSS for the profile page (Using some from registration page)-->    
        <link href="profileStyle.css" rel="stylesheet">

    </head>

    <body>
        <div id="loader"></div>
        <span id="display_switch">
            <script>

                window.addEventListener( "pageshow", function ( event ) {
                    var historyTraversal = event.persisted || 
                                        ( typeof window.performance != "undefined" && 
                                            window.performance.navigation.type === 2 );
                    if ( historyTraversal ) {
                        // Handle page restore.
                        window.location.reload();
                    }
                });


                document.getElementById("display_switch").style.display = "none";

                /*Global Variables and Objects*/
                const entry_manager = {
                    "1": {},
                    obj_keys: [1],
                    add: async function(obj){
                        //The current last key for this map
                        var last = this[this.obj_keys.length.toString()]; // ex: this['3'] if 3 is the highest key

                        //Add entry to the latest key
                        last[obj.entry_id] = obj; 

                        //Then check if the size of the latest key is over 20
                        if(Object.keys(last).length >= 3){
                            var new_int = this.obj_keys.length + 1; //getting current length
                            this.obj_keys.push(new_int) //adding incremented integer into the array
                            this[new_int.toString()] = {}; //create new empty object with incremented integer to add a new page
                        }                        
                    },
                    display: async function(curr, buy_or_supply){

                        var curr_key = Object.keys(this[this.obj_keys[curr-1].toString()]);

                        //clear the section
                        document.getElementById("entry_container").innerHTML="";  

                        //clear the no entry message
                        document.getElementById("no_entry_message").style.display="none";

                        if (curr_key.length < 1){return;}

                        //.forEach(element => entry_manager.add(element))
                        Object.keys(this[this.obj_keys[curr-1].toString()]).forEach(element => {
                            
                            //get the current object in a section while iterating through keys
                            var curr_obj = this[this.obj_keys[curr-1].toString()][element];

                            //console.log(curr_obj)
                            
                            //clone the entry element                  
                            var ent = document.getElementById("buyer-supplier-entry").cloneNode(true);

                            //Then change the display to flex
                            //ent.style.display = "flex";
                            ent.classList.add("buyer-supplier-entry-style");
                            ent.addEventListener('mouseenter', event => {
                                ent.style.background = "rgba(255, 208, 0)";
                            });

                            ent.addEventListener('mousedown', event => {
                                ent.style.background = "orangered";
                            });

                            ent.addEventListener('mouseup', event => {
                                if(ent.style.background.split(" ")[0] == "orangered"){
                                    ent.style.background = "rgba(255, 208, 0)";
                                    //do stuff here
                                    edititem(ent);
                                }
                            });

                            ent.addEventListener('mouseleave', event => {
                                ent.style.background = "white";
                            });

                            //Then fill in the details for the entry to display
                            ent.querySelector("#entry-email").innerHTML = curr_obj['email_id'];
                            ent.querySelector("#entry-phone").innerHTML = curr_obj['phone_id'];
                            ent.querySelector("#entry-company").innerHTML = curr_obj['company_name'];
                            ent.querySelector("#entry-contact").innerHTML = JSON.parse(curr_obj['contact_name']).First_Name + " " + JSON.parse(curr_obj['contact_name']).Last_Name;
                            ent.id = curr_obj['entry_id'];

                            //designate between buyer and supplier
                            if(buy_or_supply == "supplier"){
                                ent.querySelector("#entry-title").innerHTML = curr_obj['product_title'];
                                ent.querySelector("#entry-location").innerHTML = curr_obj['product_location'];
                                ent.querySelector("#entry-shipping").innerHTML = curr_obj['shipping_options'];
                                ent.querySelector("#entry-description").innerHTML = curr_obj['product_description'];                        
                                ent.querySelector("#entry-size").innerHTML = curr_obj['business_size'];
                                ent.querySelector("#entry-revenue").innerHTML = curr_obj['business_revenue'];
                                ent.querySelector("#entry-username").innerHTML = curr_obj['username'];   
                                ent.querySelector("#entry_pic").src = curr_obj['product_pictures'];             
                            }

                            if (buy_or_supply == "buyer"){
                                ent.querySelector("#entry-title").innerHTML = curr_obj['request_title'];
                                ent.querySelector("#entry-location").innerHTML = curr_obj['location_request_from'];
                                ent.querySelector("#entry-shipping").innerHTML = curr_obj['send_item_to'];
                                ent.querySelector("#entry-description").innerHTML = curr_obj['request_text'];                        
                                ent.querySelector("#entry-size").innerHTML = curr_obj['business_size'];
                                ent.querySelector("#entry-revenue").innerHTML = curr_obj['business_revenue'];
                                ent.querySelector("#entry-username").innerHTML = curr_obj['username'];

                                // Here add the picture as an entry pic
                                //'https://restcountries.eu/rest/v2/alpha/' + data.profile_info.business_country
                                //let obj_co = await (await fetch('https://restcountries.eu/rest/v2/alpha/' + curr_obj['business_country'])).json();
                                //let obj_co = "https://www.eworldtrade.com/2K19/flags/4x3/" + sessionStorage.getItem("business_country") + ".svg"
                                ent.querySelector("#entry_pic").src = "https://www.eworldtrade.com/2K19/flags/4x3/" + sessionStorage.getItem("business_country") + ".svg";
                            }  

                            //Then check if the element is displayed                            
                            document.getElementById("entry_container").append(ent);
    
                        });
                        
                    },
                    turn_left: async function(){

                        // If we are on the beginning page of the profile, we cannot move further back
                        if(parseInt(document.getElementById("current_page").innerHTML) == 1){return;}

                        //First display the previous page number
                        this.display(parseInt(document.getElementById("current_page").innerHTML) - 1, sessionStorage.getItem("buyer_or_supplier"))
                        //Then change tha page number on the webpage, no pun intended
                        document.getElementById("current_page").innerHTML = (parseInt(document.getElementById("current_page").innerHTML) - 1).toString()
        
                    },
                    turn_right: async function(){

                        // If we are on the last page, as indicated by total # of pages equivalent to the current page, we cannot move further foward
                        if(parseInt(document.getElementById("current_page").innerHTML) == parseInt(document.getElementById("total_pages").innerHTML)){return;}

                        //First display the previous page number
                        this.display(parseInt(document.getElementById("current_page").innerHTML) + 1, sessionStorage.getItem("buyer_or_supplier"))
                        //Then change tha page number on the webpage, no pun intended
                        document.getElementById("current_page").innerHTML = (parseInt(document.getElementById("current_page").innerHTML) + 1).toString()
                        
                    }
                }

                async function startup(url) {
                    if (sessionStorage.getItem('session_id') == null){
                        document.getElementById('loader').remove();
                        return;
                    }
                    sessionStorage.setItem("action_item","get_profile");
                    let response = await fetch(url,{method:'POST', body: JSON.stringify(sessionStorage), headers:{'Content-Type' : 'application/json'}});
                    var data = await response.json();
                    sessionStorage.setItem("business_country", data.profile_info.business_country)

                    /*keys of data JSON: ['profile_info'(object), 'entries'(array)]*/
    
                    //Here I am filling in the profile fields with the contents from the JSON above
                    document.getElementById("BuyerSupplier_grab").innerHTML= data.profile_info.buyer_or_supplier;
                    document.getElementById("Name_grab").innerHTML= JSON.parse(data.profile_info.contact_name).First_Name + " " + JSON.parse(data.profile_info.contact_name).Last_Name;
                    document.getElementById("Company_grab").innerHTML= data.profile_info.company_name;
                    document.getElementById("Title_grab").innerHTML= data.profile_info.position_title;
                    document.getElementById("ManagementGrade_grab").innerHTML= data.profile_info.management_grade;
                    document.getElementById("Location_grab").innerHTML= data.profile_info.business_address;
                    document.getElementById("EmployeeSize_grab").innerHTML= data.profile_info.business_size;
                    document.getElementById("Revenue_grab").innerHTML= data.profile_info.business_revenue;
                    document.getElementById("Email_grab").innerHTML= data.profile_info.email_id;
                    document.getElementById("Phone_grab").innerHTML= data.profile_info.phone_id;
                    document.getElementById("Username_grab").innerHTML= data.profile_info.username;
                    document.getElementById("Industry_grab").innerHTML= data.profile_info.industry;
                    sessionStorage.setItem("buyer_or_supplier", data.profile_info.buyer_or_supplier); // add buyer/supplier designation in session storage

                    // Getting the country name from the restcountries REST api
                    //'https://restcountries.eu/rest/v2/alpha/' + data.profile_info.business_country
                    //let obj_co = await (await fetch('https://restcountries.eu/rest/v2/alpha/' + data.profile_info.business_country)).json();
                    let obj_co = await (await fetch("http://api.worldbank.org/v2/country/" + data.profile_info.business_country + "?format=json")).json();

                    document.getElementById("Country_grab").innerHTML = obj_co['1']['0']['name']
                    
                    //Starting with buyer page, will switch to supplier if the data tells otherwise
                    document.getElementById("BuyerSupplier_grab2").innerHTML= data.profile_info.buyer_or_supplier + " offers";
                    document.getElementById("BuyerSupplier_grab2").style.marginLeft="57px";
                    document.getElementById("additemoffer").style.marginLeft="375px";
                    if (data.profile_info.buyer_or_supplier == "supplier") {
                        document.getElementById("BuyerSupplier_grab2").innerHTML= data.profile_info.buyer_or_supplier + " items";
                        document.getElementById("BuyerSupplier_grab2").style.marginLeft="45px";
                        document.getElementById("additemoffer").style.marginLeft="374px";
                    }
                    else {                                
                        /********************************************* code block for changing supplier form to a buyer form ***************************************/
                        //Change title to "Add Offer" and make changes to exit button positioning
                        document.getElementById("pop_up_title").innerHTML = "Add Offer"

                        //Then remove the Photo submission Title
                        document.getElementById("product photo title").remove();

                        //Then remove the input submission element
                        document.getElementById("product_photo").remove(); 
                        document.getElementById("product_photo2").remove(); 

                        /*Then remove the photo element from dummy entry so blank photo icon doesn't appear in buyer offers when we clone
                        document.getElementById("entry-photo").remove();*/

                        //Then change the placeholders for the existing boxes
                        document.getElementById("product_title").placeholder = "Please Input Offer Title*";
                        document.getElementById("product_description").placeholder = "Tell Us About Your Offer*";
                        document.getElementById("product_shipping").placeholder = "Please Input Where You Want Item Sent*";
                        /******************************************************************************************************************************************/
                    }

                    //Add entries from sent in data JSON into the entry manager (json profile_request_pack = var data)                   
                    if (data.entries.length > 0){data.entries.forEach(element => entry_manager.add(element));}
                    
                    //Set the total pages
                    document.getElementById("total_pages").innerHTML = entry_manager.obj_keys.length.toString();
                    if(Object.keys(entry_manager["1"]).length > 0){entry_manager.display(1,data.profile_info.buyer_or_supplier)}
                                       
                    //console.log(entry_manager);
                    //console.log(data.entries.length);

                    //remove loader and reveal screen
                    document.getElementById('loader').remove();
                    if (sessionStorage.getItem('session_id') !== null) {document.getElementById("display_switch").style.display = "";}                    

                    return data;
                }  

                // will only display loading screen until further notice from async function
                //console.log(sessionStorage.getItem('session_id') + "hdhdh"); //here session_id is the username

            </script>
            
            <nav>
                <div class="header-spacing">
                    <span class="heading">TreCom</span>
                    <span class="nav-text">
                        <b>                  
                            <span class="navlink"><a href="#">About</a></span>
                            <span class="navlink"><a href="../Home_Page/index.html">Home</a></span>
                            <span class="navlink"><a href="../Buyer_Page/buyer.html">Buyers</a></span>
                            <span class="navlink"><a href="../Supplier_Page/supplier.html">Suppliers</a></span>
                        </b> 
                        <a>
                            <img src="/profile_pic_placeholder.png" onerror="this.src = '../../../src/server/Profile_Pictures/profile_pic_placeholder.png';" class="profilepicture profile_pic_hovering">
                            <img src="/imageonline-co-invertedimage.png" onerror="this.src = '../../../src/server/Profile_Pictures/imageonline-co-invertedimage.png';" class="profilepictureinverted profile_pic_hovering">
                            <div id="profile_dropdown" style="display: none">
                                <div id="logout_profilebuttondropdown" class="profile_dropdown_options">Logout</div>
                            </div>
                        </a>
                    </span>             
                </div>
            </nav>

            <br><br><br><br><br><br>

            <!--This is the top three boxes, profile info, buyer/supplier entries, and the about section of the profiles-->
            <div class="toprow">

                <div class="profile-section">
                    <div id="profile-section-container" style="margin-left: -15px; margin-right: -15px;">
                        <p style="padding-left: 117px;"><b><a id="edit_link">Edit</a></b></p>
                        <p><img src="/profile_pic_placeholder.png" onerror="this.src = '../../../src/server/Profile_Pictures/profile_pic_placeholder.png';" class="dashboard_pic"></p>
                        <p><b><span id="BuyerSupplier_grab"></span></b></p>
                        <p><b>Name: </b><span id="Name_grab"></span></p>
                        <p><b>Company: </b><span id="Company_grab"></span></p>
                        <p><b>Title: </b><span id="Title_grab"></span></p>
                        <p><b>Management Grade: </b><span id="ManagementGrade_grab"></span></p>
                        <p><b>Location: </b><span id="Location_grab"></span></p>
                        <p><b>Country: </b><span id="Country_grab"></span></p>
                        <p><b>Employee Size: </b><span id="EmployeeSize_grab"></span></p>
                        <p><b>Revenue (Annual): </b><span id="Revenue_grab"></span></p>
                        <p><b>Email: </b><span id="Email_grab"></span></p>
                        <p><b>Phone: </b><span id="Phone_grab"></span></p>
                        <p><b>Username: </b>@<span id="Username_grab"></span></p>
                        <p><b>Industry: </b><span id="Industry_grab"></span></p>
                    </div>
                </div>


                <div class="buyer_supplier_items">
                    
                    <!-- this is a title-->
                    <div style="display: flex">
                        <b><p class="items_title" id="BuyerSupplier_grab2">Buyer Offers/Supplier Items</p></b>
                        <a id="additemoffer" style="margin-top: 13px; margin-left: 299px; height:0px; color:royalblue; cursor: pointer;"><b>+add</b></a>
                    </div>

                    <!--this is the default message for no entries-->
                    <div id="no_entry_message">
                        <b>Press '+add' to Create a New Entry.</b>
                    </div>

                    <!--container for the entries from the entry manager-->
                    <div id="entry_container" style="margin-bottom: 105px;"></div>


                    <!-- this is a dummy entry-->
                    <div id="buyer-supplier-entry" style="margin-bottom: 30px;"> 
                        <div id="entry-photo"><img id="entry_pic" src="/item-placeholder.png" style="width:200px; height: 200px;"></div>
                        <div id="item_details">
                            <div class="buyer-supplier-container" style="display: flex;">
                                <div style="margin-left: 10px; margin-top:10px; margin-bottom:-5px;"><h2 id="entry-title" style="display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden;">Product Title</h2></div>
                            </div>
                            <div class="buyer-supplier-container" style="display: flex;">
                                <div style="margin-left: 10px; font-size: 12px; width: 235px; display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden;">Location: <span id="entry-location">United States of America</span></div>
                                <div style="margin-left: 5px; font-size: 12px; width: 162px; display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden;">Ship To: <span id="entry-shipping">Everywhere</span></div>
                            </div>    
                            <div class="buyer-supplier-container" style="display: -webkit-box; -webkit-line-clamp: 7; -webkit-box-orient: vertical; overflow: hidden;">
                                <div style="margin-left: 10px; margin-top:10px; font-size: 12px;">Description: <span id="entry-description">This product is an item</span></div>
                            </div>
                        </div>
                        <div id="vl"></div>

                        <div id="user-info">                        
                            <p class="user-overflow">Company: <span id="entry-company">Staples .Inc</span></p> 
                            <p class="user-overflow">Size: <span id="entry-size">500-700</span></p>
                            <p class="user-overflow">Revenue: <span id="entry-revenue">$500k-$700k</span></p>
                            <p class="user-overflow">Contact: <span id="entry-contact">Trent Shillingford</span></p>
                            <p class="user-overflow">Username: @<span id="entry-username">Tshill22</span></p>
                            <p class="user-overflow">Email: <span id="entry-email">tshillingford1@gmail.com</span></p>
                            <p class="user-overflow">Phone: <span id="entry-phone">845-694-9017</span></p>
                        </div>
                    </div>
                    <!-- end of dummy entry -->

                    <div id="navigation_pad" style="position: absolute; bottom: 0; margin-top: 30px;">
                        <div style="margin-bottom: 5px;"><span style="cursor: pointer; margin-left: 455px;"><img id="previous_page" src="/left_arrow.png" onerror="this.src = '../../../src/server/Profile_Pictures/left_arrow.png';" class="page_arrows"></span><span style="margin-left: 40px; cursor: pointer;"><img id="next_page" src="/right_arrow.png" onerror="this.src = '../../../src/server/Profile_Pictures/right_arrow.png';" class="page_arrows"></span></div>
                        <div style="margin-left: 17px; margin-bottom: 10px;"><span id="current_page">1</span> of <span id="total_pages">1</span></div>                
                    </div>
                </div>

                <div class="about">
                    <b><p class="about_title">About <a href="#" id="addaboout" style="margin-left: 82px; color:royalblue;">+add</a></p></b>
                    <p style="padding-left: 30px; padding-right: 30px;">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi lobortis dolor metus, at posuere odio cursus eu. Cras sed mollis massa. Aliquam neque orci, faucibus ac bibendum varius, egestas vitae est. 
                    Nulla vitae tempor quam. Donec accumsan ex at justo feugiat, non interdum nulla fringilla. Duis varius rutrum imperdiet. Proin sed arcu sit amet tortor convallis sollicitudin ac nec orci. In hac habitasse platea dictumst.
                    Pellentesque sed ex vel dui porttitor porttitor. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. 
                    </p>
                </div>

            </div>

            <!-- <div class="bottomrow"> Turn this into a bottom row class

                <div class="companies_engaged">
                    <b><p class="companies_engaged_title">Companies Engaged <a href="#" id="addcompaniesengaged" style="margin-left: 20px; color:royalblue;">+add</a> </p></b>
                    <ul>
                        <li>Staples</li>
                        <li>Raymour & Flanigan</li>
                    </ul> 
                </div>


                <div class="industry">
                    <b><p class="industry_title">Industry<a href="#" id="userprofiledit" style="margin-left: 90px; color:royalblue;">Edit</a> </p></b>
                    <ul>
                            <li id="Industry_grab">cheese</li>
                    </ul>              
                </div>

            </div>-->

        </span>

        <span id="pop_up_background" style="display: none;"></span>
        <div id="pop_up_form" style="display: none;"> 

            <div id="pop_up_firstRowContainer">
                <button class="button red" id="delete_item" style="display: none;"><b>Delete</b></button>
                <div id="pop_up_title">Add Item</div>
                <img src="/cancel.png" onerror="this.src = '../../../src/server/Profile_Pictures/cancel.png';" class="exit_out" id="exit1">
            </div>

            <div id="pop_up_container">
                <form id="pop_up_container_additem" style="display:none;">

                    <div class="product_header">Title</div>
                    <input type="text" class="product_details" id="product_title" placeholder="Please Input Item Title*" required>

                    <div class="product_header">Description</div>
                    <textarea rows="10" class="product_details" id="product_description" type="text" placeholder="Tell Us About Your Product*" required></textarea> 

                    <div class="product_header">Location</div>
                    <input type="text" class="product_details" id="product_location" placeholder="Please Input Location*" required>   

                    <div class="product_header"pop_up_form>Ship To</div>
                    <input type="text" class="product_details" id="product_shipping" placeholder="Please Input Where You Can Send Item*" required>
                    
                    <div class="product_header" id="product photo title">Upload Product Photo</div>
                    <input type="file" class="product_details" id="product_photo" name="product_photo" required> 

                    <div class="product_header"></div> 
                    <button form="pop_up_container_additem" formmethod="post" class="button blue" type="submit"><b>Submit</b></button><span id="pop_up_success" style="color: green; font-size: 15px; margin-left: 5px; font-family:'Noto Sans JP',sans-serif"></span>

                </form>

                <form id="pop_up_container_edit_link" style="display:none;">

                    <div class="product_header">First Name</div>
                    <input type="text" class="product_details" id="personal_first_name" required> <span id="first_name_error" style="color: red; font-size: 10px; font-family:'Noto Sans JP',sans-serif"></span>

                    <div class="product_header">Last Name</div>
                    <input type="text" class="product_details" id="personal_last_name" required> <span id="last_name_error" style="color: red; font-size: 10px; font-family:'Noto Sans JP',sans-serif"></span>

                    <div class="product_header">Company Name</div>
                    <input type="text" class="product_details" id="personal_company" required> <span id="company_error" style="color: red; font-size: 10px; font-family:'Noto Sans JP',sans-serif"></span>  

                    <div class="product_header">Position Title</div>
                    <input type="text" class="product_details" id="personal_title" required> <span id="position_error" style="color: red; font-size: 10px; font-family:'Noto Sans JP',sans-serif"></span> 

                    <div class="product_header">Management Grade</div>        
                    <select class="product_details" name="Select_Management_Grade" id="personal_management_grade">
                        <option value="C-Suite">C-Suite</option>
                        <option value="Managing Director">Managing Director</option>
                        <option value="President">President</option>
                        <option value="Vice President">Vice President</option>
                        <option value="Director">Director</option>
                        <option value="Manager">Manager</option>
                        <option value="Analyst">Analyst</option>
                        <option value="Other">Other</option>
                    </select>  

                    <div class="product_header">Business Address</div>
                    <textarea rows="10" class="product_details" id="personal_location" type="text" required></textarea> <span id="address_error" style="color: red; font-size: 10px; font-family:'Noto Sans JP',sans-serif"></span>

                    <div class="product_header">Country of Business</div>
                    <select class="product_details" name="Select_Country" id="personal_country">
                        <option value="af">Afghanistan</option>
                        <option value="ax">Åland Islands</option>
                        <option value="al">Albania</option>
                        <option value="dz">Algeria</option>
                        <option value="as">American Samoa</option>
                        <option value="ad">Andorra</option>
                        <option value="ao">Angola</option>
                        <option value="ai">Anguilla</option>
                        <option value="aq">Antarctica</option>
                        <option value="ag">Antigua and Barbuda</option>
                        <option value="ar">Argentina</option>
                        <option value="am">Armenia</option>
                        <option value="aw">Aruba</option>
                        <option value="au">Australia</option>
                        <option value="at">Austria</option>
                        <option value="az">Azerbaijan</option>
                        <option value="bs">Bahamas</option>
                        <option value="bh">Bahrain</option>
                        <option value="bd">Bangladesh</option>
                        <option value="bb">Barbados</option>
                        <option value="by">Belarus</option>
                        <option value="be">Belgium</option>
                        <option value="bz">Belize</option>
                        <option value="bj">Benin</option>
                        <option value="bm">Bermuda</option>
                        <option value="bt">Bhutan</option>
                        <option value="bo">Bolivia (Plurinational State of)</option>
                        <option value="bq">Bonaire, Sint Eustatius and Saba[a]</option>
                        <option value="ba">Bosnia and Herzegovina</option>
                        <option value="bw">Botswana</option>
                        <option value="bv">Bouvet Island</option>
                        <option value="br">Brazil</option>
                        <option value="io">British Indian Ocean Territory</option>
                        <option value="bn">Brunei Darussalam</option>
                        <option value="bg">Bulgaria</option>
                        <option value="bf">Burkina Faso</option>
                        <option value="bi">Burundi</option>
                        <option value="cv">Cabo Verde</option>
                        <option value="kh">Cambodia</option>
                        <option value="cm">Cameroon</option>
                        <option value="ca">Canada</option>
                        <option value="ky">Cayman Islands</option>
                        <option value="cf">Central African Republic</option>
                        <option value="td">Chad</option>
                        <option value="cl">Chile</option>
                        <option value="cn">China</option>
                        <option value="cx">Christmas Island</option>
                        <option value="cc">Cocos (Keeling) Islands</option>
                        <option value="co">Colombia</option>
                        <option value="km">Comoros</option>
                        <option value="cg">Congo</option>
                        <option value="cd">Congo, Democratic Republic of the</option>
                        <option value="ck">Cook Islands</option>
                        <option value="cr">Costa Rica</option>
                        <option value="ci">Côte d'Ivoire</option>
                        <option value="hr">Croatia</option>
                        <option value="cu">Cuba</option>
                        <option value="cw">Curaçao</option>
                        <option value="cy">Cyprus</option>
                        <option value="cz">Czechia</option>
                        <option value="dk">Denmark</option>
                        <option value="dj">Djibouti</option>
                        <option value="dm">Dominica</option>
                        <option value="do">Dominican Republic</option>
                        <option value="ec">Ecuador</option>
                        <option value="eg">Egypt</option>
                        <option value="sv">El Salvador</option>
                        <option value="gq">Equatorial Guinea</option>
                        <option value="er">Eritrea</option>
                        <option value="ee">Estonia</option>
                        <option value="sz">Eswatini</option>
                        <option value="et">Ethiopia</option>
                        <option value="fk">Falkland Islands (Malvinas)</option>
                        <option value="fo">Faroe Islands</option>
                        <option value="fj">Fiji</option>
                        <option value="fi">Finland</option>
                        <option value="fr">France</option>
                        <option value="gf">French Guiana</option>
                        <option value="pf">French Polynesia</option>
                        <option value="tf">French Southern Territories</option>
                        <option value="ga">Gabon</option>
                        <option value="gm">Gambia</option>
                        <option value="ge">Georgia</option>
                        <option value="de">Germany</option>
                        <option value="gh">Ghana</option>
                        <option value="gi">Gibraltar</option>
                        <option value="gr">Greece</option>
                        <option value="gl">Greenland</option>
                        <option value="gd">Grenada</option>
                        <option value="gp">Guadeloupe</option>
                        <option value="gu">Guam</option>
                        <option value="gt">Guatemala</option>
                        <option value="gg">Guernsey</option>
                        <option value="gn">Guinea</option>
                        <option value="gw">Guinea-Bissau</option>
                        <option value="gy">Guyana</option>
                        <option value="ht">Haiti</option>
                        <option value="hm">Heard Island and McDonald Islands</option>
                        <option value="va">Holy See</option>
                        <option value="hn">Honduras</option>
                        <option value="hk">Hong Kong</option>
                        <option value="hu">Hungary</option>
                        <option value="is">Iceland</option>
                        <option value="in">India</option>
                        <option value="id">Indonesia</option>
                        <option value="ir">Iran (Islamic Republic of)</option>
                        <option value="iq">Iraq</option>
                        <option value="ie">Ireland</option>
                        <option value="im">Isle of Man</option>
                        <option value="il">Israel</option>
                        <option value="it">Italy</option>
                        <option value="jm">Jamaica</option>
                        <option value="jp">Japan</option>
                        <option value="je">Jersey</option>
                        <option value="jo">Jordan</option>
                        <option value="kz">Kazakhstan</option>
                        <option value="ke">Kenya</option>
                        <option value="ki">Kiribati</option>
                        <option value="kp">Korea (Democratic People's Republic of)</option>
                        <option value="kr">Korea, Republic of</option>
                        <option value="kw">Kuwait</option>
                        <option value="kg">Kyrgyzstan</option>
                        <option value="la">Lao People's Democratic Republic</option>
                        <option value="lv">Latvia</option>
                        <option value="lb">Lebanon</option>
                        <option value="ls">Lesotho</option>
                        <option value="lr">Liberia</option>
                        <option value="ly">Libya</option>
                        <option value="li">Liechtenstein</option>
                        <option value="lt">Lithuania</option>
                        <option value="lu">Luxembourg</option>
                        <option value="mo">Macao</option>
                        <option value="mg">Madagascar</option>
                        <option value="mw">Malawi</option>
                        <option value="my">Malaysia</option>
                        <option value="mv">Maldives</option>
                        <option value="ml">Mali</option>
                        <option value="mt">Malta</option>
                        <option value="mh">Marshall Islands</option>
                        <option value="mq">Martinique</option>
                        <option value="mr">Mauritania</option>
                        <option value="mu">Mauritius</option>
                        <option value="yt">Mayotte</option>
                        <option value="mx">Mexico</option>
                        <option value="fm">Micronesia (Federated States of)</option>
                        <option value="md">Moldova, Republic of</option>
                        <option value="mc">Monaco</option>
                        <option value="mn">Mongolia</option>
                        <option value="me">Montenegro</option>
                        <option value="ms">Montserrat</option>
                        <option value="ma">Morocco</option>
                        <option value="mz">Mozambique</option>
                        <option value="mm">Myanmar</option>
                        <option value="na">Namibia</option>
                        <option value="nr">Nauru</option>
                        <option value="np">Nepal</option>
                        <option value="nl">Netherlands</option>
                        <option value="nc">New Caledonia</option>
                        <option value="nz">New Zealand</option>
                        <option value="ni">Nicaragua</option>
                        <option value="ne">Niger</option>
                        <option value="ng">Nigeria</option>
                        <option value="nu">Niue</option>
                        <option value="nf">Norfolk Island</option>
                        <option value="mk">North Macedonia</option>
                        <option value="mp">Northern Mariana Islands</option>
                        <option value="no">Norway</option>
                        <option value="om">Oman</option>
                        <option value="pk">Pakistan</option>
                        <option value="pw">Palau</option>
                        <option value="ps">Palestine, State of</option>
                        <option value="pa">Panama</option>
                        <option value="pg">Papua New Guinea</option>
                        <option value="py">Paraguay</option>
                        <option value="pe">Peru</option>
                        <option value="ph">Philippines</option>
                        <option value="pn">Pitcairn</option>
                        <option value="pl">Poland</option>
                        <option value="pt">Portugal</option>
                        <option value="pr">Puerto Rico</option>
                        <option value="qa">Qatar</option>
                        <option value="re">Réunion</option>
                        <option value="ro">Romania</option>
                        <option value="ru">Russian Federation</option>
                        <option value="rw">Rwanda</option>
                        <option value="bl">Saint Barthélemy</option>
                        <option value="sh">Saint Helena, Ascension and Tristan da Cunha[b]</option>
                        <option value="kn">Saint Kitts and Nevis</option>
                        <option value="lc">Saint Lucia</option>
                        <option value="mf">Saint Martin (French part)</option>
                        <option value="pm">Saint Pierre and Miquelon</option>
                        <option value="vc">Saint Vincent and the Grenadines</option>
                        <option value="ws">Samoa</option>
                        <option value="sm">San Marino</option>
                        <option value="st">Sao Tome and Principe</option>
                        <option value="sa">Saudi Arabia</option>
                        <option value="sn">Senegal</option>
                        <option value="rs">Serbia</option>
                        <option value="sc">Seychelles</option>
                        <option value="sl">Sierra Leone</option>
                        <option value="sg">Singapore</option>
                        <option value="sx">Sint Maarten (Dutch part)</option>
                        <option value="sk">Slovakia</option>
                        <option value="si">Slovenia</option>
                        <option value="sb">Solomon Islands</option>
                        <option value="so">Somalia</option>
                        <option value="za">South Africa</option>
                        <option value="gs">South Georgia and the South Sandwich Islands</option>
                        <option value="ss">South Sudan</option>
                        <option value="es">Spain</option>
                        <option value="lk">Sri Lanka</option>
                        <option value="sd">Sudan</option>
                        <option value="sr">Suriname</option>
                        <option value="sj">Svalbard and Jan Mayen[c]</option>
                        <option value="se">Sweden</option>
                        <option value="ch">Switzerland</option>
                        <option value="sy">Syrian Arab Republic</option>
                        <option value="tw">Taiwan, Province of China</option>
                        <option value="tj">Tajikistan</option>
                        <option value="tz">Tanzania, United Republic of</option>
                        <option value="th">Thailand</option>
                        <option value="tl">Timor-Leste</option>
                        <option value="tg">Togo</option>
                        <option value="tk">Tokelau</option>
                        <option value="to">Tonga</option>
                        <option value="tt">Trinidad and Tobago</option>
                        <option value="tn">Tunisia</option>
                        <option value="tr">Turkey</option>
                        <option value="tm">Turkmenistan</option>
                        <option value="tc">Turks and Caicos Islands</option>
                        <option value="tv">Tuvalu</option>
                        <option value="ug">Uganda</option>
                        <option value="ua">Ukraine</option>
                        <option value="ae">United Arab Emirates</option>
                        <option value="gb">United Kingdom of Great Britain and Northern Ireland</option>
                        <option value="us">United States of America</option>
                        <option value="um">United States Minor Outlying Islands[e]</option>
                        <option value="uy">Uruguay</option>
                        <option value="uz">Uzbekistan</option>
                        <option value="vu">Vanuatu</option>
                        <option value="ve">Venezuela (Bolivarian Republic of)</option>
                        <option value="vn">Viet Nam</option>
                        <option value="vg">Virgin Islands (British)</option>
                        <option value="vi">Virgin Islands (U.S.)</option>
                        <option value="wf">Wallis and Futuna</option>
                        <option value="eh">Western Sahara</option>
                        <option value="ye">Yemen</option>
                        <option value="zm">Zambia</option>
                        <option value="zw">Zimbabwe</option>
                        <option value="Other">Other</option>
                    </select>
    
                    <div class="product_header">Employee Size</div>
                    <input type="text" class="product_details" id="personal_size" required> <span id="size_error" style="color: red; font-size: 10px; font-family:'Noto Sans JP',sans-serif"></span>

                    <div class="product_header">Business Revenue (Annual)</div>
                    <input type="text" class="product_details" id="personal_revenue" required> <span id="revenue_error" style="color: red; font-size: 10px; font-family:'Noto Sans JP',sans-serif"></span>

                    <div class="product_header">Phone</div>
                    <input type="text" class="product_details" id="personal_phone" required> <span id="phone_error" style="color: red; font-size: 10px; font-family:'Noto Sans JP',sans-serif"></span>

                    <div class="product_header">Industry of Business</div>        
                    <select class="product_details" name="Select_Industry" id="personal_industry">
                        <option value="Agriculture">Agriculture</option>
                        <option value="Mining">Mining</option>
                        <option value="Utilities">Utilities</option>
                        <option value="Construction">Construction</option>
                        <option value="Manufacturing">Manufacturing</option>
                        <option value="Trade(Wholesale/Retail)">Trade(Wholesale/Retail)</option>
                        <option value="Transportation & Warehousing">Transportation & Warehousing</option>
                        <option value="Information">Information</option>
                        <option value="Finance">Finance</option>
                        <option value="Insurance">Insurance</option>
                        <option value="Real Estate">Real Estate</option>
                        <option value="Technology">Technology</option>
                        <option value="Science">Science</option>
                        <option value="Administration">Administration</option>
                        <option value="Education">Education</option>
                        <option value="Healthcare/Public Health">Healthcare/Public Health</option>
                        <option value="Other">Other</option>
                    </select>  

                    <div class="product_header"></div> 
                    <button form="pop_up_container_edit_link" formmethod="post" class="button blue" type="submit"><b>Submit</b></button><span id="pop_up_success2" style="color: green; font-size: 15px; margin-left: 5px; font-family:'Noto Sans JP',sans-serif"></span>
                    
                </form>     
                
                <form id="pop_up_container_edit_item" style="display:none;">

                    <div class="product_header">Title</div>
                    <input type="text" class="product_details" id="product_title2" placeholder="Please Input Item Title*" required>

                    <div class="product_header">Description</div>
                    <textarea rows="10" class="product_details" id="product_description2" type="text" placeholder="Tell Us About Your Product*" required></textarea> 

                    <div class="product_header">Location</div>
                    <input type="text" class="product_details" id="product_location2" placeholder="Please Input Location*" required>   

                    <div class="product_header"pop_up_form>Ship To</div>
                    <input type="text" class="product_details" id="product_shipping2" placeholder="Please Input Where You Can Send Item*" required>
                    
                    <div class="product_header" id="product photo title">Change Product Photo</div>
                    <input type="file" class="product_details" id="product_photo2" name="product_photo"> 

                    <div class="product_header"></div> 
                    <button form="pop_up_container_edit_item" formmethod="post" class="button blue" type="submit"><b>Submit</b></button><span id="pop_up_success3" style="color: green; font-size: 15px; margin-left: 5px; font-family:'Noto Sans JP',sans-serif"></span>

                </form>
            </div>
        
        </div>

        <script>

            // Input form for both buyers and suppliers
            // This JSON will be used for both buyers AND suppliers (will provide mapping)
            var form_data = new FormData();

            async function send_details(url) {
                let response = await fetch(url,{method: 'POST', body: form_data});
                var data = await response.json();
                return data;
            }   
            
            const select_prefill = function(grab, personal){
                var temp = document.getElementById(grab).innerHTML;
                var mySelect = document.getElementById(personal);

                for(var i, j = 0; i = mySelect.options[j]; j++) {
                    if(i.innerHTML == temp) {
                        mySelect.selectedIndex = j;
                        break;
                    }
                }
            }

            const validate_edits = function(form_data){

                function voidOnlySpaces(arg){return (!(arg.replaceAll(' ', '') == ""))}

                function validatename(arg) {            
                    var regex = /^[a-zA-Z ]{2,30}$/;
                    var regex2 = /^\S*$/;
                    if(arg.replaceAll(' ', '') == ""){return false;}
                    return (regex.test(arg) && regex2.test(arg));
                }

                function showError(id){
                    document.getElementById(id).innerHTML = "Improper Input. Try Again."
                    return false;
                }

                document.getElementById("first_name_error").innerHTML = "";
                document.getElementById("last_name_error").innerHTML = "";
                document.getElementById("company_error").innerHTML = "";
                document.getElementById("position_error").innerHTML = "";
                document.getElementById("address_error").innerHTML = "";
                document.getElementById("size_error").innerHTML = "";
                document.getElementById("revenue_error").innerHTML = "";
                document.getElementById("phone_error").innerHTML = "";

                if(!(validatename(form_data.get('First_Name')))){return showError("first_name_error");}
                if(!(validatename(form_data.get('Last_Name')))){return showError("last_name_error");}
                if(!(voidOnlySpaces(form_data.get('Company')))){return showError("company_error");}
                if(!(voidOnlySpaces(form_data.get('Title')))){return showError("position_error");}
                if(!(voidOnlySpaces(form_data.get('Address')))){return showError("address_error");}
                if(!(voidOnlySpaces(form_data.get('Size')))){return showError("size_error");}
                if(!(voidOnlySpaces(form_data.get('Revenue')))){return showError("revenue_error");}
                if(!(voidOnlySpaces(form_data.get('Phone')))){return showError("phone_error");}

                return true;

            }

            const edititem = function(ent){
                document.getElementById("pop_up_title").innerHTML="Edit Entry";
                document.getElementById("pop_up_container_additem").style.display="none";
                document.getElementById("pop_up_container_edit_link").style.display="none";
                document.getElementById("delete_item").style.display = "";
                document.getElementById("pop_up_title").style.marginLeft = "391px";
                document.getElementById("pop_up_background").style.display="";
                document.getElementById("pop_up_form").style.display="";
                document.getElementById("product_title2").value = ent.querySelector("#entry-title").innerHTML;
                document.getElementById("product_description2").innerHTML = ent.querySelector("#entry-description").innerHTML;
                document.getElementById("product_location2").value = ent.querySelector("#entry-location").innerHTML;
                document.getElementById("product_shipping2").value = ent.querySelector("#entry-shipping").innerHTML;

                sessionStorage.setItem("entry_id", ent.id.toString()); //saving the entry id for storage specifically 

                document.getElementById("pop_up_container_edit_item").style.display="";
                //ent.querySelector("#entry-username").innerHTML = curr_obj['username'];   
                //ent.id = curr_obj['entry_id'];   
            }

            is_status_complete = async () => {
                var status_check = await send_details('/additem');
                if(status_check.statusmsg == "db_success"){

                    //First we want to add the element to the last page        
                    if(sessionStorage.getItem("buyer_or_supplier") == "supplier"){
                        var new_entry = {
                                "entry_id": status_check.entry_id,
                                "email_id": status_check.email_id,
                                "phone_id": status_check.phone_id,
                                "company_name": status_check.company_name,
                                "contact_name": status_check.contact_name,
                                "product_title": form_data.get('Title'),
                                "product_location": form_data.get('Location'), 
                                "shipping_options": form_data.get('Shipping'),
                                "product_description": form_data.get('Description'),
                                "business_size": status_check.business_size,  
                                "business_revenue": status_check.business_revenue,
                                "username": status_check.username,
                                "product_pictures": status_check.photo
                            };
                        await entry_manager.add(new_entry);
                    }
                    else{
                        var new_entry = {
                                "username": status_check.username,
                                "entry_id": status_check.entry_id,
                                "email_id": status_check.email_id,
                                "phone_id": status_check.phone_id,
                                "business_country": status_check.business_country,
                                "business_size": status_check.business_size,
                                "business_revenue": status_check.business_revenue,
                                "company_name": status_check.company_name,
                                "contact_name": status_check.contact_name,
                                "request_title": form_data.get('Title'),
                                "location_request_from": form_data.get('Location'),
                                "send_item_to": form_data.get('Shipping'),
                                "request_text": form_data.get('Description')
                        };
                        await entry_manager.add(new_entry);
                    }

                    //Refreshing the items on my page if I am on the last page and I added something
                    if(document.getElementById("current_page").innerHTML == document.getElementById("total_pages").innerHTML){
                        entry_manager.display(parseInt(document.getElementById("current_page").innerHTML),sessionStorage.getItem("buyer_or_supplier"));
                    }

                    //Then refresh the total number of pages for continuity
                    document.getElementById("total_pages").innerHTML = entry_manager.obj_keys.length.toString();              

                    //Bookkeeping for exiting the prompt
                    document.getElementById("pop_up_success").style.color = "green";
                    document.getElementById("pop_up_success").innerHTML = "Complete";
                    document.getElementById("pop_up_form").style.display="none";
                    document.getElementById("pop_up_background").style.display="none";
                    document.getElementById("pop_up_container_additem").reset();
                    document.getElementById("pop_up_success").innerHTML = "";
                }
                else{
                    document.getElementById("pop_up_success").style.color = 'red';
                    document.getElementById("pop_up_success").innerHTML = "Error"; 
                }
                console.log(status_check.statusmsg);
            }  

            is_profile_change_complete = async () => {

                if(validate_edits(form_data)){
                    var status_check = await send_details('/updateitem');

                    if(status_check.statusmsg == "db_success"){
                    document.getElementById("pop_up_success2").style.color = 'Green';
                    document.getElementById("pop_up_success2").innerHTML = "Complete"; 
                    window.location.replace("../Profile-Page/profile.html"); 
                    }
                }

                document.getElementById("pop_up_success2").style.color = 'red';
                document.getElementById("pop_up_success2").innerHTML = "Error";   

            }
  
            is_item_change_complete = async (endpoint) => {
                
                var status_check = await send_details(endpoint);

                if(status_check.statusmsg == "db_success"){
                document.getElementById("pop_up_success2").style.color = 'Green';
                document.getElementById("pop_up_success2").innerHTML = "Complete"; 
                window.location.replace("../Profile-Page/profile.html"); 
                }

                document.getElementById("pop_up_success2").style.color = 'red';
                document.getElementById("pop_up_success2").innerHTML = "Error";   

            }

            document.getElementById("additemoffer").addEventListener("click",function(event){
                document.getElementById("pop_up_title").innerHTML="Add Item";
                document.getElementById("pop_up_title").style.marginLeft = "446px";
                if (document.getElementById("BuyerSupplier_grab").innerHTML == "buyer"){document.getElementById("pop_up_title").innerHTML="Add Offer";}
                document.getElementById("pop_up_container_edit_link").style.display="none";
                document.getElementById("pop_up_container_edit_item").style.display="none";
                document.getElementById("delete_item").style.display = "none";                
                document.getElementById("pop_up_background").style.display="";
                document.getElementById("pop_up_form").style.display="";      
                document.getElementById("pop_up_container_additem").style.display="";    
            });

            document.getElementById("edit_link").addEventListener("click",function(event){
                document.getElementById("pop_up_title").innerHTML="Edit Profile Details";
                document.getElementById("pop_up_title").style.marginLeft = "418px";

                //Prepopulate the values in the "Edit Profile Details" form
                document.getElementById("personal_first_name").value = document.getElementById("Name_grab").innerHTML.split(' ')[0];
                document.getElementById("personal_last_name").value = document.getElementById("Name_grab").innerHTML.split(' ')[1];
                document.getElementById("personal_company").value = new DOMParser().parseFromString(document.getElementById("Company_grab").innerHTML, "text/html").body.innerText;
                document.getElementById("personal_title").value = document.getElementById("Title_grab").innerHTML;
                document.getElementById("personal_location").innerHTML = new DOMParser().parseFromString(document.getElementById("Location_grab").innerHTML, "text/html").body.innerText;
                document.getElementById("personal_size").value = document.getElementById("EmployeeSize_grab").innerHTML;
                document.getElementById("personal_revenue").value = document.getElementById("Revenue_grab").innerHTML;
                document.getElementById("personal_phone").value = document.getElementById("Phone_grab").innerHTML;
                select_prefill("Country_grab","personal_country");
                select_prefill("Industry_grab","personal_industry");
                select_prefill("ManagementGrade_grab","personal_management_grade"); 
                document.getElementById("pop_up_container_additem").style.display="none";
                document.getElementById("pop_up_container_edit_item").style.display="none";           
                document.getElementById("delete_item").style.display = "none";
                document.getElementById("pop_up_background").style.display="";
                document.getElementById("pop_up_form").style.display="";      
                document.getElementById("pop_up_container_edit_link").style.display="";
            });

            //Then do a submit function for editing the entry and we should be good....
            document.getElementById("pop_up_container_edit_item").addEventListener("submit",function(event){

                event.preventDefault();// Preventing the form submitting immediately 

                if (document.getElementById("pop_up_success3").innerHTML == "Loading"){return;}// prevent other jobs in eventqueue to process while loading
                if (document.getElementById("pop_up_success3").innerHTML == "Complete"){return;}// prevent other jobs in eventqueue to process when complete
                document.getElementById("pop_up_success3").style.color = 'black';
                document.getElementById("pop_up_success3").innerHTML = "Loading";   

                form_data = new FormData(); // Clear from data if used in a previous operation on this webpage  
                
                form_data.append('action_item',"edititem")
                form_data.append('username', sessionStorage.getItem('session_id'))
                form_data.append('Title', document.getElementById("product_title2").value)
                form_data.append('Description', document.getElementById("product_description2").value.trim())
                form_data.append('Location', document.getElementById("product_location2").value)
                form_data.append('Shipping', document.getElementById("product_shipping2").value)
                form_data.append('Buyer_or_Supplier', sessionStorage.getItem("buyer_or_supplier"))
                form_data.append('entry_id', sessionStorage.getItem("entry_id"))
                if(sessionStorage.getItem("buyer_or_supplier") == "supplier"){
                    if(document.getElementById("product_photo2").files[0] != undefined){
                        form_data.append('Item_Photo',document.getElementById("product_photo2").files[0]);
                    }
                }                

                //console.log(form_data.entries());

                is_item_change_complete('/edititem');

            }); 

            document.getElementById("exit1").addEventListener("click",function(event){
                if (document.getElementById("pop_up_success").innerHTML == "Loading"){return;}// prevent other jobs in eventqueue to process while loading    
                document.getElementById("pop_up_container_additem").style.display="none";
                document.getElementById("pop_up_container_edit_link").style.display="none";
                document.getElementById("pop_up_container_edit_item").style.display="none";
                document.getElementById("pop_up_form").style.display="none";           
                document.getElementById("pop_up_background").style.display="none";
                document.getElementById("delete_item").style.display = "none";
                document.getElementById("pop_up_container_edit_link").reset();
                document.getElementById("pop_up_container_additem").reset();
                document.getElementById("pop_up_container_edit_item").reset();
            });

            document.getElementById("pop_up_container_additem").addEventListener("submit",function(event){
                
                event.preventDefault();// Preventing the form submitting immediately 

                if (document.getElementById("pop_up_success").innerHTML == "Loading"){return;}// prevent other jobs in eventqueue to process while loading
                if (document.getElementById("pop_up_success").innerHTML == "Complete"){return;}// prevent other jobs in eventqueue to process when complete
                document.getElementById("pop_up_success").style.color = 'black';
                document.getElementById("pop_up_success").innerHTML = "Loading";   

                form_data = new FormData(); // Clear from data if used in a previous operation on this webpage                    
                
                form_data.append('action_item',"additem")
                form_data.append('username', sessionStorage.getItem('session_id'))
                form_data.append('Title', document.getElementById("product_title").value)
                form_data.append('Description', document.getElementById("product_description").value.trim())
                form_data.append('Location', document.getElementById("product_location").value)
                form_data.append('Shipping', document.getElementById("product_shipping").value)
                form_data.append('Buyer_or_Supplier', sessionStorage.getItem("buyer_or_supplier"))
                if(sessionStorage.getItem("buyer_or_supplier") == "supplier"){form_data.append('Item_Photo',document.getElementById("product_photo").files[0]);}                

                //console.log(form_data.entries());

                is_status_complete();

            });

            document.getElementById("pop_up_container_edit_link").addEventListener("submit",function(event){ //Need to add more from the registration to profile
                event.preventDefault();
                if (document.getElementById("pop_up_success2").innerHTML == "Loading"){return;}// prevent other jobs in eventqueue to process while loading
                if (document.getElementById("pop_up_success2").innerHTML == "Complete"){return;}// prevent other jobs in eventqueue to process when complete
                document.getElementById("pop_up_success2").style.color = 'black';
                document.getElementById("pop_up_success2").innerHTML = "Loading";   
                form_data = new FormData();
                form_data.append('action_item',"edit_profile");
                form_data.append('username', sessionStorage.getItem('session_id'));
                form_data.append('First_Name', document.getElementById("personal_first_name").value);
                form_data.append('Last_Name', document.getElementById("personal_last_name").value);
                form_data.append('Company', document.getElementById("personal_company").value);
                form_data.append('Title', document.getElementById("personal_title").value);
                form_data.append('Management_Grade', document.getElementById("personal_management_grade").value);
                form_data.append('Address', document.getElementById("personal_location").value.trim());
                form_data.append('Country', document.getElementById("personal_country").value);
                form_data.append('Size', document.getElementById("personal_size").value);
                form_data.append('Revenue', document.getElementById("personal_revenue").value);
                form_data.append('Phone', document.getElementById("personal_phone").value);
                form_data.append('Industry', document.getElementById("personal_industry").value);
                form_data.append('Buyer_or_Supplier', sessionStorage.getItem("buyer_or_supplier"));

                is_profile_change_complete();
            });

            document.getElementById("delete_item").addEventListener("click",function(event){
                if (document.getElementById("pop_up_success").innerHTML == "Loading"){return;}// prevent other jobs in eventqueue to process while loading
                if (document.getElementById("pop_up_success").innerHTML == "Complete"){return;}// prevent other jobs in eventqueue to process when complete
                document.getElementById("pop_up_success").style.color = 'black';
                document.getElementById("pop_up_success").innerHTML = "Loading";   
                form_data = new FormData(); // Clear from data if used in a previous operation on this webpage                    
                form_data.append('action_item',"deleteitem");
                form_data.append('username', sessionStorage.getItem('session_id'));
                form_data.append('entry_id', sessionStorage.getItem('entry_id'));
                form_data.append('Buyer_or_Supplier', sessionStorage.getItem("buyer_or_supplier")); 
                is_item_change_complete('/deleteitem');
            });

            document.getElementById("previous_page").addEventListener("click",function(event){    
                entry_manager.turn_left();
            });

            document.getElementById("next_page").addEventListener("click",function(event){    
                entry_manager.turn_right();
            });

            document.querySelectorAll('.profile_pic_hovering').forEach(item => {
                item.addEventListener('mouseover', event => {
                    document.getElementById("profile_dropdown").style.display = "";
                });
            });

            document.getElementById("profile_dropdown").addEventListener("mouseleave",function(event){    
                document.getElementById("profile_dropdown").style.display = "none";
            });

            document.getElementById("logout_profilebuttondropdown").addEventListener("click",function(event){                 
                //clear the sesstion storage and reload the page; this will remove all user info
                sessionStorage.clear();            
                //if one needs to log in, send them to the login page
                location.assign("../Supplier_Page/supplier.html");                
            });

            startup('/profile');

        </script>

    </body>

</html>